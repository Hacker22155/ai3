<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Secure Access Terminal</title>
  <style>
    /* Reset & Basic Styling */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Courier New', monospace;
      background: #000;
      color: #0f0;
      overflow: hidden;
    }
    .container {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      position: relative;
      padding: 20px;
    }
    /* Glitch Title Effect */
    .glitch-title {
      font-size: 3rem;
      text-align: center;
      position: relative;
      color: #f00;
      animation: glitch 1s infinite;
    }
    @keyframes glitch {
      0% {
        text-shadow: 2px 2px #0ff, -2px -2px #f0f;
      }
      20% {
        text-shadow: -2px -2px #0ff, 2px 2px #f0f;
      }
      40% {
        text-shadow: 2px -2px #0ff, -2px 2px #f0f;
      }
      60% {
        text-shadow: -2px 2px #0ff, 2px -2px #f0f;
      }
      80% {
        text-shadow: 2px 2px #0ff, -2px -2px #f0f;
      }
      100% {
        text-shadow: -2px -2px #0ff, 2px 2px #f0f;
      }
    }
    /* Keypad Section */
    .keypad-section {
      display: flex;
      justify-content: center;
      margin: 20px auto;
    }
    .keypad-container {
      background: rgba(0, 0, 0, 0.8);
      border: 1px solid #0f0;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 15px #0f0;
    }
    .pin-display {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
    }
    .pin-dots {
      display: flex;
      gap: 10px;
    }
    .pin-dot {
      width: 20px;
      height: 20px;
      border: 2px solid #0f0;
      border-radius: 50%;
      background: transparent;
    }
    .pin-dot.active {
      background: #0f0;
    }
    .keypad-grid {
      display: grid;
      grid-template-columns: repeat(3, 80px);
      grid-gap: 10px;
      justify-content: center;
    }
    .key {
      background: transparent;
      border: 2px solid #0f0;
      color: #0f0;
      font-size: 1.5rem;
      padding: 15px;
      border-radius: 4px;
      cursor: pointer;
      transition: transform 0.2s;
      position: relative;
      overflow: hidden;
    }
    .key:hover {
      transform: scale(1.05);
      animation: outlineAnimate 0.5s forwards;
    }
    @keyframes outlineAnimate {
      0% {
        box-shadow: 0 0 0 0 rgba(0, 255, 213, 0.7);
      }
      100% {
        box-shadow: 0 0 10px 5px rgba(0, 255, 213, 0);
      }
    }
    .key.clicked {
      transform: scale(0.95);
    }
    /* Log Section */
    .log-section {
      margin-top: 20px;
    }
    .log-container {
      background: rgba(0, 0, 0, 0.8);
      border: 1px solid #0f0;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 0 15px #0f0;
      max-height: 200px;
      overflow-y: auto;
    }
    .log-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .attempts-counter {
      font-size: 1.2rem;
    }
    .log-content {
      font-size: 0.9rem;
      line-height: 1.4;
    }
    .log-entry {
      margin-bottom: 10px;
      border-bottom: 1px solid #0f0;
      padding-bottom: 5px;
    }
    .timestamp {
      font-size: 0.8rem;
      color: #aaa;
    }
    /* Overlay Effects for Dark Hacking Vibe */
    .overlay,
    .scanlines,
    .glow {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }
    .overlay {
      background: rgba(0, 0, 0, 0.7);
    }
    .scanlines {
      background: repeating-linear-gradient(
        to bottom,
        transparent,
        transparent 2px,
        rgba(0, 255, 213, 0.1) 2px,
        rgba(0, 255, 213, 0.1) 3px
      );
    }
    .glow {
      mix-blend-mode: screen;
      animation: glowAnim 3s infinite;
    }
    @keyframes glowAnim {
      0% {
        opacity: 0.5;
      }
      50% {
        opacity: 1;
      }
      100% {
        opacity: 0.5;
      }
    }
    /* Mobile Responsiveness */
    @media (max-width: 600px) {
      .keypad-grid {
        grid-template-columns: repeat(3, 60px);
        grid-gap: 8px;
      }
      .key {
        font-size: 1.2rem;
        padding: 10px;
      }
      .glitch-title {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1 class="glitch-title">ERROR: ACCESS DENIED</h1>
    </header>
    <main>
      <section class="keypad-section">
        <div class="keypad-container">
          <div class="pin-display">
            <div class="pin-dots">
              <span class="pin-dot"></span>
              <span class="pin-dot"></span>
              <span class="pin-dot"></span>
              <span class="pin-dot"></span>
            </div>
          </div>
          <div class="keypad-grid">
            <button class="key" data-key="1">1</button>
            <button class="key" data-key="2">2</button>
            <button class="key" data-key="3">3</button>
            <button class="key" data-key="4">4</button>
            <button class="key" data-key="5">5</button>
            <button class="key" data-key="6">6</button>
            <button class="key" data-key="7">7</button>
            <button class="key" data-key="8">8</button>
            <button class="key" data-key="9">9</button>
            <button class="key key-delete" data-key="delete">DEL</button>
            <button class="key" data-key="0">0</button>
            <button class="key key-unlock" data-key="unlock">OK</button>
          </div>
        </div>
      </section>
      <section class="log-section">
        <div class="log-container">
          <div class="log-header">
            <h2>CIPHER ATTEMPT LOG</h2>
            <div class="attempts-counter">
              <span class="attempts-text">ATTEMPTS REMAINING:</span>
              <span class="attempts-number">5</span>
            </div>
          </div>
          <div class="log-content" id="log-content">
            <div class="log-placeholder">
              <div class="scanner-line"></div>
              <p>ENTER ACCESS CODE</p>
              <p>5 ATTEMPTS BEFORE SECURITY LOCKDOWN</p>
            </div>
          </div>
        </div>
      </section>
    </main>
    <div class="overlay"></div>
    <div class="scanlines"></div>
    <div class="glow"></div>
  </div>
  <script>
    const PIN_LENGTH = 4;
    const MAX_ATTEMPTS = 5;
    // Generate a random PIN with unique digits (used when input isn't the special override)
    const CORRECT_PIN = (() => {
      const digits = new Set();
      while (digits.size < 4) {
        digits.add(Math.floor(Math.random() * 10));
      }
      return Array.from(digits).join('');
    })();

    const pinDots = document.querySelectorAll('.pin-dot');
    const keys = document.querySelectorAll('.key');
    const attemptsCounter = document.querySelector('.attempts-number');
    const logContent = document.getElementById('log-content');
    const container = document.querySelector('.container');

    let currentPin = '';
    let attemptsRemaining = MAX_ATTEMPTS;
    let isLocked = false;

    function init() {
      addEventListeners();
      animateElements();
    }

    function addEventListeners() {
      keys.forEach(key => {
        key.addEventListener('click', () => handleKeyPress(key));
        key.addEventListener('mouseenter', () => {
          playSound('hover');
        });
      });
      document.addEventListener('keydown', (e) => {
        if (e.code === 'Space') {
          toggleBackgroundAudio();
        }
      });
    }

    function handleKeyPress(key) {
      if (isLocked) return;
      key.classList.add('clicked');
      setTimeout(() => key.classList.remove('clicked'), 300);
      playSound('keypress');
      const keyValue = key.getAttribute('data-key');
      switch (keyValue) {
        case 'delete':
          deleteLastDigit();
          break;
        case 'unlock':
          attemptUnlock();
          break;
        default:
          if (currentPin.length < PIN_LENGTH) {
            addDigit(keyValue);
          }
      }
    }

    function addDigit(digit) {
      if (currentPin.length < PIN_LENGTH) {
        currentPin += digit;
        updatePinDisplay();
        if (currentPin.length === PIN_LENGTH) {
          setTimeout(attemptUnlock, 500);
        }
      }
    }

    function deleteLastDigit() {
      if (currentPin.length > 0) {
        currentPin = currentPin.slice(0, -1);
        updatePinDisplay();
      }
    }

    function updatePinDisplay() {
      pinDots.forEach((dot, index) => {
        if (index < currentPin.length) {
          dot.classList.add('active');
        } else {
          dot.classList.remove('active');
        }
      });
    }

    function attemptUnlock() {
      if (currentPin.length !== PIN_LENGTH) {
        shakeEffect('.pin-display');
        playSound('error');
        return;
      }
      // Special redirect for the override password "2215"
      if (currentPin === "2215") {
        window.location.href = "index.html";
        return;
      }
      attemptsRemaining--;
      attemptsCounter.textContent = attemptsRemaining;
      const isCorrect = checkPin(currentPin);
      if (isCorrect) {
        handleSuccessfulUnlock();
      } else {
        handleFailedAttempt();
      }
      currentPin = '';
      updatePinDisplay();
    }

    function checkPin(pin) {
      return pin === CORRECT_PIN;
    }

    function getPinFeedback(enteredPin) {
      const feedback = [];
      for (let i = 0; i < PIN_LENGTH; i++) {
        if (i < enteredPin.length) {
          const digit = enteredPin[i];
          if (digit === CORRECT_PIN[i]) {
            feedback.push('correct');
          } else if (CORRECT_PIN.includes(digit)) {
            feedback.push('wrong-position');
          } else {
            feedback.push('wrong');
          }
        } else {
          feedback.push('empty');
        }
      }
      return feedback;
    }

    function handleSuccessfulUnlock() {
      playSound('success');
      addLogEntry({
        message: 'ACCESS GRANTED - DECRYPTION SUCCESSFUL',
        pin: currentPin,
        feedback: getPinFeedback(currentPin),
        type: 'success'
      });
      container.classList.add('access-granted');
      document.body.style.animation = 'pulseSuccess 0.5s 3';
      setTimeout(() => {
        alert('Access granted! System unlocked.');
        resetSystem();
      }, 1500);
    }

    function handleFailedAttempt() {
      playSound('error');
      shakeEffect('.keypad-container');
      addLogEntry({
        message: `INVALID PIN - ATTEMPT ${MAX_ATTEMPTS - attemptsRemaining} OF ${MAX_ATTEMPTS}`,
        pin: currentPin,
        feedback: getPinFeedback(currentPin),
        type: 'error'
      });
      if (attemptsRemaining <= 0) {
        setTimeout(lockSystem, 500);
      }
    }

    function lockSystem() {
      isLocked = true;
      const lockMessage = 'SECURITY BREACH DETECTED - SYSTEM LOCKED';
      addLogEntry({
        message: lockMessage,
        type: 'error',
        isLockout: true
      });
      playSound('lockdown');
      shakeEffect('.keypad-container', 10);
      shakeEffect('.log-container', 10);
      container.classList.add('system-locked');
      setTimeout(() => {
        alert('Too many failed attempts. System locked!');
        resetSystem();
      }, 3000);
    }

    function resetSystem() {
      currentPin = '';
      attemptsRemaining = MAX_ATTEMPTS;
      isLocked = false;
      updatePinDisplay();
      attemptsCounter.textContent = attemptsRemaining;
      container.classList.remove('system-locked', 'access-granted');
      if (logContent.querySelector('.log-placeholder')) {
        return;
      }
      logContent.innerHTML = `
        <div class="log-placeholder">
          <div class="scanner-line"></div>
          <p>ENTER ACCESS CODE</p>
          <p>5 ATTEMPTS BEFORE SECURITY LOCKDOWN</p>
        </div>
      `;
      playSound('reset');
    }

    function addLogEntry(entry) {
      const placeholder = logContent.querySelector('.log-placeholder');
      if (placeholder) {
        logContent.removeChild(placeholder);
      }
      const logEntry = document.createElement('div');
      logEntry.className = `log-entry ${entry.type || ''}`;
      const now = new Date();
      const timestamp = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}:${now.getSeconds().toString().padStart(2, '0')}.${now.getMilliseconds().toString().padStart(3, '0')}`;
      let logHTML = `<div class="timestamp">[${timestamp}]</div>`;
      logHTML += `<div class="message">${entry.message}</div>`;
      if (entry.pin && entry.feedback) {
        logHTML += '<div class="code">';
        for (let i = 0; i < PIN_LENGTH; i++) {
          if (i < entry.pin.length) {
            const digitClass = entry.feedback[i];
            logHTML += `<div class="digit ${digitClass}">${entry.pin[i]}</div>`;
          } else {
            logHTML += `<div class="digit">-</div>`;
          }
        }
        logHTML += '</div>';
      }
      if (entry.isLockout) {
        logHTML += `
          <div class="lockout-animation">
            <div class="lockout-text">SYSTEM LOCKDOWN</div>
          </div>
        `;
      }
      logEntry.innerHTML = logHTML;
      logContent.appendChild(logEntry);
      logContent.scrollTop = logContent.scrollHeight;
    }

    function shakeEffect(selector, intensity = 5) {
      const element = document.querySelector(selector);
      element.style.animation = `shake 0.5s cubic-bezier(.36,.07,.19,.97) both`;
      element.style.transform = `translate3d(0, 0, 0)`;
      const keyframes = `
        @keyframes shake {
          10%, 90% { transform: translate3d(${-intensity}px, 0, 0); }
          20%, 80% { transform: translate3d(${intensity * 2}px, 0, 0); }
          30%, 50%, 70% { transform: translate3d(${-intensity * 2}px, 0, 0); }
          40%, 60% { transform: translate3d(${intensity * 2}px, 0, 0); }
        }
      `;
      let style = document.getElementById('shake-style');
      if (!style) {
        style = document.createElement('style');
        style.id = 'shake-style';
        document.head.appendChild(style);
      }
      style.innerHTML = keyframes;
      setTimeout(() => {
        element.style.animation = '';
      }, 500);
    }

    function playSound(type) {
      if (!window.audioContext) {
        window.audioContext = new (window.AudioContext || window.webkitAudioContext)();
      }
      const context = window.audioContext;
      const oscillator = context.createOscillator();
      const gain = context.createGain();
      oscillator.connect(gain);
      gain.connect(context.destination);
      switch (type) {
        case 'keypress':
          oscillator.type = 'sine';
          oscillator.frequency.setValueAtTime(880, context.currentTime);
          oscillator.frequency.exponentialRampToValueAtTime(440, context.currentTime + 0.1);
          gain.gain.setValueAtTime(0.2, context.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.1);
          oscillator.start(context.currentTime);
          oscillator.stop(context.currentTime + 0.1);
          break;
        case 'error':
          oscillator.type = 'sawtooth';
          oscillator.frequency.setValueAtTime(300, context.currentTime);
          oscillator.frequency.setValueAtTime(280, context.currentTime + 0.1);
          oscillator.frequency.setValueAtTime(260, context.currentTime + 0.2);
          gain.gain.setValueAtTime(0.3, context.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.3);
          oscillator.start(context.currentTime);
          oscillator.stop(context.currentTime + 0.3);
          break;
        case 'success':
          oscillator.type = 'sine';
          oscillator.frequency.setValueAtTime(440, context.currentTime);
          oscillator.frequency.setValueAtTime(554, context.currentTime + 0.1);
          oscillator.frequency.setValueAtTime(659, context.currentTime + 0.2);
          gain.gain.setValueAtTime(0.3, context.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.3);
          oscillator.start(context.currentTime);
          oscillator.stop(context.currentTime + 0.3);
          break;
        case 'lockdown':
          oscillator.type = 'triangle';
          oscillator.frequency.setValueAtTime(180, context.currentTime);
          oscillator.frequency.setValueAtTime(150, context.currentTime + 0.1);
          oscillator.frequency.setValueAtTime(120, context.currentTime + 0.2);
          oscillator.frequency.setValueAtTime(100, context.currentTime + 0.3);
          gain.gain.setValueAtTime(0.4, context.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.4);
          oscillator.start(context.currentTime);
          oscillator.stop(context.currentTime + 0.4);
          break;
        case 'hover':
          oscillator.type = 'sine';
          oscillator.frequency.setValueAtTime(1760, context.currentTime);
          gain.gain.setValueAtTime(0.05, context.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.05);
          oscillator.start(context.currentTime);
          oscillator.stop(context.currentTime + 0.05);
          break;
        case 'reset':
          oscillator.type = 'sine';
          oscillator.frequency.setValueAtTime(659, context.currentTime);
          oscillator.frequency.setValueAtTime(554, context.currentTime + 0.1);
          oscillator.frequency.setValueAtTime(440, context.currentTime + 0.2);
          gain.gain.setValueAtTime(0.2, context.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.3);
          oscillator.start(context.currentTime);
          oscillator.stop(context.currentTime + 0.3);
          break;
      }
    }

    let backgroundAudio = null;
    function createBackgroundAudio() {
      if (!window.audioContext) {
        window.audioContext = new (window.AudioContext || window.webkitAudioContext)();
      }
      const context = window.audioContext;
      const bufferSize = 2 * context.sampleRate;
      const noiseBuffer = context.createBuffer(1, bufferSize, context.sampleRate);
      const output = noiseBuffer.getChannelData(0);
      for (let i = 0; i < bufferSize; i++) {
        output[i] = Math.random() * 2 - 1;
      }
      const noise = context.createBufferSource();
      noise.buffer = noiseBuffer;
      noise.loop = true;
      const filter = context.createBiquadFilter();
      filter.type = 'lowpass';
      filter.frequency.value = 400;
      const gain = context.createGain();
      gain.gain.value = 0.03;
      noise.connect(filter);
      filter.connect(gain);
      gain.connect(context.destination);
      noise.start(0);
      return {
        noise,
        gain,
        filter,
        isPlaying: true
      };
    }
    function toggleBackgroundAudio() {
      if (!backgroundAudio) {
        backgroundAudio = createBackgroundAudio();
      } else {
        if (backgroundAudio.isPlaying) {
          backgroundAudio.gain.gain.value = 0;
          backgroundAudio.isPlaying = false;
        } else {
          backgroundAudio.gain.gain.value = 0.03;
          backgroundAudio.isPlaying = true;
        }
      }
    }
    function animateElements() {
      const glow = document.querySelector('.glow');
      setInterval(() => {
        const x = Math.random() * 100;
        const y = Math.random() * 100;
        glow.style.background = `radial-gradient(circle at ${x}% ${y}%, rgba(0, 255, 213, 0.1), transparent 70%)`;
      }, 3000);
      document.addEventListener('click', () => {
        if (!backgroundAudio) {
          backgroundAudio = createBackgroundAudio();
        }
      }, { once: true });
    }
    init();
  </script>
</body>
</html>
